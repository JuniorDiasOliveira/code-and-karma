---
import { getCollection } from "astro:content";
import Layout from "../layouts/Layout.astro";
import Header from "../components/layout/Header.astro";
import Footer from "../components/layout/Footer.astro";
import BlogCard from "../components/content/BlogCard.astro";
import { LightningFX } from "../components/islands/Light-FX.tsx";
import HeroSilhouettes from "../components/islands/HeroSilhouettes.tsx";
import { SimpleLoader } from "../components/islands/SimpleLoader.tsx";

const allPosts = await getCollection("blog");
const sortedPosts = allPosts.sort(
  (a, b) => new Date(b.data.date).getTime() - new Date(a.data.date).getTime()
);
---

<Layout title="Karma & Code">
  <SimpleLoader client:only="react" minLoadTime={3000}>
    <div class="flex flex-col bg-background text-foreground">
      <Header />
      <LightningFX
        client:only="react"
        minDelayMs={3000}
        maxDelayMs={12000}
        strongCountRange={[2, 4]}
        weakCountRange={[1, 3]}
        hue={200}
        allAtOnceChance={0.2}
      >
        <section
          class="relative isolate overflow-hidden bg-[#0A0C10] py-28 md:py-36 z-20"
        >
          <!-- AURA RADIAL de fundo -->
          <div
            class="pointer-events-none absolute inset-0 -z-10 bg-[radial-gradient(1200px_600px_at_50%_110%,rgba(0,255,255,0.10),transparent_60%)] anim-aura"
            style="animation: auraPulse 9s ease-in-out infinite;"
          >
          </div>
          <div
            class="pointer-events-none absolute inset-0 -z-10 bg-[radial-gradient(900px_500px_at_80%_20%,rgba(255,0,255,0.08),transparent_60%)] blur-3xl anim-aura"
            style="animation: auraPulse 11s ease-in-out infinite reverse;"
          >
          </div>

          <div
            class="pointer-events-none absolute -top-12 left-1/3 h-64 w-64 -z-10 rounded-full blur-2xl bg-[conic-gradient(from_180deg_at_50%_50%,rgba(0,255,255,.18),rgba(255,0,255,.12),transparent)] mix-blend-screen opacity-30 anim-drift"
            style="animation: drift 14s ease-in-out infinite;"
          >
          </div>
          <div
            class="pointer-events-none absolute bottom-0 right-20 h-72 w-72 -z-10 rounded-full blur-3xl bg-[radial-gradient(circle,rgba(0,255,255,.14),transparent_60%)] mix-blend-screen opacity-40 anim-drift"
            style="animation: drift 16s ease-in-out infinite reverse;"
          >
          </div>

          <div class="container mx-auto px-4">
            <div class="max-w-3xl">
              <h1
                class="text-5xl md:text-7xl font-extrabold tracking-tight select-none bg-linear-to-r from-secondary via-[#FF00FF] to-[#FF00FF] bg-clip-text text-transparent neon-heading"
              >
                Karma & Code
              </h1>

              <p class="mt-6 text-lg md:text-xl text-zinc-400 leading-relaxed">
                Exploring the edge of front-end development: React, TypeScript,
                design systems, sometimes an Angular, and sometimes nothing to
                do with nothing.
              </p>

              <div class="mt-10 flex flex-wrap gap-4">
                <a
                  href="/blog"
                  class="px-6 py-3 rounded-full border border-cyan-400/40 text-cyan-300 hover:bg-cyan-500/10 hover:border-cyan-400/60 transition"
                >
                  View Articles
                </a>
                <a
                  href="/projects"
                  class="px-6 py-3 rounded-full border border-fuchsia-400/40 text-fuchsia-300 hover:bg-fuchsia-500/10 hover:border-fuchsia-400/60 transition"
                >
                  View Projects and Experiments
                </a>
              </div>
            </div>
          </div>

          <!-- brilho de base (linha do horizonte) -->
          <div
            class="pointer-events-none absolute bottom-0 left-0 right-0 h-24 -z-10 bg-linear-to-t from-[#00ffff1a] to-transparent"
          >
          </div>
        </section>
        <HeroSilhouettes />
      </LightningFX>
    </div>

    <!-- Featured Posts Section -->
    <section class="container py-12">
      <div class="flex items-center gap-3 mb-8">
        <h2 class="text-3xl font-bold neon-glow-cyan text-secondary">
          Latest Articles
        </h2>
        <div
          class="h-px flex-1 bg-linear-to-r from-secondary/50 to-transparent"
        >
        </div>
      </div>

      <div class="grid gap-6 md:grid-cols-2 lg:grid-cols-3">
        {
          sortedPosts.map((post) => (
            <BlogCard
              slug={post.slug}
              title={post.data.title}
              excerpt={post.data.excerpt}
              date={post.data.date}
              tags={post.data.tags}
              readTime={post.data.readTime}
            />
          ))
        }
      </div>
    </section>

    <!-- Tech Stack Section -->
    <section class="container py-16">
      <div
        class="bg-card/30 backdrop-blur-sm border border-border/50 rounded-lg p-8 neon-border-glow"
      >
        <h3 class="text-2xl font-bold mb-4 neon-gradient-text">
          Built with Modern Tech
        </h3>
        <div class="grid grid-cols-2 md:grid-cols-4 gap-4 text-center">
          <div class="p-4 bg-background/50 rounded-lg border border-primary/30">
            <p class="font-mono text-primary font-semibold">Astro</p>
          </div>
          <div
            class="p-4 bg-background/50 rounded-lg border border-secondary/30"
          >
            <p class="font-mono text-secondary font-semibold">Tailwind CSS 4</p>
          </div>
          <div class="p-4 bg-background/50 rounded-lg border border-accent/30">
            <p class="font-mono text-accent font-semibold">TypeScript</p>
          </div>
          <div class="p-4 bg-background/50 rounded-lg border border-primary/30">
            <p class="font-mono text-primary font-semibold">Markdown</p>
          </div>
        </div>
      </div>
    </section>

    <Footer />
  </LoadingWrapper>
</Layout>
