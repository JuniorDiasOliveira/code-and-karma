---
import { getCollection } from "astro:content";
import Layout from "../layouts/Layout.astro";
import Header from "../components/layout/Header.astro";
import Footer from "../components/layout/Footer.astro";
import BlogCard from "../components/content/BlogCard.astro";

// Buscar todos os posts do blog
const allPosts = await getCollection("blog");
const sortedPosts = allPosts.sort(
  (a, b) => new Date(b.data.date).getTime() - new Date(a.data.date).getTime()
);

// EstatÃ­sticas
const totalPosts = allPosts.length;
const allTags = [...new Set(allPosts.flatMap(post => post.data.tags))];
const recentPosts = sortedPosts.slice(0, 6);
const olderPosts = sortedPosts.slice(6);
---

<Layout title="All Articles | Code & Karma" description="Explore all articles about front-end development, React, TypeScript, design systems and more">
  <div class="min-h-screen flex flex-col bg-background text-foreground">
    <Header />

    <main class="flex-1">
      <!-- Hero Section -->
      <section class="relative isolate overflow-hidden bg-[#0A0C10] py-16 md:py-24">
        <!-- Background effects -->
        <div
          class="pointer-events-none absolute inset-0 -z-10 bg-[radial-gradient(800px_400px_at_50%_110%,rgba(0,255,255,0.08),transparent_60%)] anim-aura"
          style="animation: auraPulse 12s ease-in-out infinite;"
        >
        </div>
        
        <div class="container mx-auto px-4">
          <div class="max-w-3xl">
            <h1 class="text-4xl md:text-6xl font-extrabold tracking-tight select-none bg-linear-to-r from-secondary via-[#00FFFF] to-[#00FFFF] bg-clip-text text-transparent neon-heading">
              All Articles
            </h1>

            <p class="mt-6 text-lg md:text-xl text-zinc-400 leading-relaxed">
              {totalPosts} articles covering front-end development, React, TypeScript, design systems, and the ever-evolving world of web development.
            </p>

            <!-- Stats -->
            <div class="mt-8 flex flex-wrap gap-6 text-sm">
              <div class="flex items-center gap-2 text-primary">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 8h6v4H7V8z"></path>
                </svg>
                <span>{totalPosts} Articles</span>
              </div>
              
              <div class="flex items-center gap-2 text-secondary">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"></path>
                </svg>
                <span>{allTags.length} Topics</span>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Recent Posts Section -->
      {recentPosts.length > 0 && (
        <section class="container py-12">
          <div class="flex items-center gap-3 mb-8">
            <h2 class="text-3xl font-bold neon-glow-cyan text-secondary">
              Latest Articles
            </h2>
            <div class="h-px flex-1 bg-linear-to-r from-secondary/50 to-transparent">
            </div>
          </div>

          <div class="grid gap-6 md:grid-cols-2 lg:grid-cols-3">
            {recentPosts.map((post) => (
              <BlogCard
                slug={post.slug}
                title={post.data.title}
                excerpt={post.data.excerpt}
                date={post.data.date}
                tags={post.data.tags}
                readTime={post.data.readTime}
              />
            ))}
          </div>
        </section>
      )}

      <!-- All Posts Section -->
      {olderPosts.length > 0 && (
        <section class="container pb-16">
          <div class="flex items-center gap-3 mb-8">
            <h2 class="text-2xl font-bold text-foreground">
              Archive
            </h2>
            <div class="h-px flex-1 bg-linear-to-r from-muted/50 to-transparent">
            </div>
          </div>

          <div class="grid gap-6 md:grid-cols-2 lg:grid-cols-3">
            {olderPosts.map((post) => (
              <BlogCard
                slug={post.slug}
                title={post.data.title}
                excerpt={post.data.excerpt}
                date={post.data.date}
                tags={post.data.tags}
                readTime={post.data.readTime}
              />
            ))}
          </div>
        </section>
      )}

      <!-- Topics Section -->
      <section class="container pb-16">
        <div class="bg-card/30 backdrop-blur-sm border border-border/50 rounded-lg p-8 neon-border-glow">
          <h3 class="text-2xl font-bold mb-6 neon-gradient-text">
            Explore by Topic
          </h3>
          
          <div class="flex flex-wrap gap-3">
            {allTags.map((tag) => (
              <span class="inline-flex items-center px-3 py-1.5 rounded-full text-sm font-medium bg-primary/10 text-primary border border-primary/30 hover:bg-primary/20 transition-all cursor-pointer">
                #{tag}
              </span>
            ))}
          </div>
          
          <p class="text-muted-foreground mt-4 text-sm">
            Click on any topic to filter articles (feature coming soon)
          </p>
        </div>
      </section>

      <!-- Back to Home -->
      <section class="container pb-16">
        <div class="text-center">
          <a
            href="/"
            class="inline-flex items-center gap-2 px-6 py-3 rounded-full bg-linear-to-r from-primary/20 to-secondary/20 border border-primary/40 text-primary hover:from-primary/30 hover:to-secondary/30 hover:border-primary/60 transition-all neon-button-glow"
          >
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
            </svg>
            Back to Home
          </a>
        </div>
      </section>
    </main>

    <Footer />
  </div>
</Layout>