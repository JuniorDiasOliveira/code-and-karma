---
import { getCollection } from "astro:content";
import Layout from "../layouts/Layout.astro";
import { Header, Footer, PageContainer } from "../components";
import ProjectCard from "../components/content/ProjectCard.astro";
import Icon from "../components/ui/Icon.astro";
import StatsDisplay from "../components/ui/StatsDisplay.astro";

const allProjects = await getCollection("projects");
const projects = allProjects.sort((a, b) => {
  if (a.data.featured && !b.data.featured) return -1;
  if (!a.data.featured && b.data.featured) return 1;
  if (a.data.order !== b.data.order) return a.data.order - b.data.order;
  return new Date(b.data.date).getTime() - new Date(a.data.date).getTime();
});

// Stats para o componente
const projectsStats = [
  { icon: 'beaker', value: `${projects.length} Projects`, color: 'primary' as const },
  { icon: 'code', value: 'Open Source', color: 'secondary' as const }
];
---

<Layout title="Projects | Code & Karma" description="Explore my latest projects, experiments, and open-source contributions in web development">
  <PageContainer>
    <Header />

    <main class="flex-1">
      <!-- Hero Section -->
      <section class="relative isolate overflow-hidden bg-[#0A0C10] py-16 md:py-24">
        <!-- Background effects -->
        <div
          class="pointer-events-none absolute inset-0 -z-10 bg-[radial-gradient(800px_400px_at_50%_110%,rgba(255,0,255,0.08),transparent_60%)] anim-aura"
          style="animation: auraPulse 15s ease-in-out infinite;"
        >
        </div>
        
        <div class="container mx-auto px-4">
          <div class="max-w-3xl">
            <h1 class="text-4xl md:text-6xl font-extrabold tracking-tight select-none bg-linear-to-r from-primary via-[#FF00FF] to-[#FF00FF] bg-clip-text text-transparent neon-heading">
              Projects & Experiments
            </h1>

            <p class="mt-6 text-lg md:text-xl text-zinc-400 leading-relaxed">
              A collection of my latest projects, experiments, and contributions to the open-source community. From production apps to creative coding experiments.
            </p>

            <!-- Stats -->
            <StatsDisplay stats={projectsStats} />
          </div>
        </div>
      </section>

      <!-- Projects Grid -->
      <section class="container py-16">
        <div class="grid gap-8 md:grid-cols-2">
          {projects.map((project) => (
            <ProjectCard
              slug={project.slug}
              title={project.data.title}
              description={project.data.description}
              technologies={project.data.technologies}
              status={project.data.status}
              github={project.data.github}
              demo={project.data.demo}
              color={project.data.color}
              featured={project.data.featured}
              date={project.data.date}
            />
          ))}
        </div>
      </section>

    </main>

    <Footer />
  </PageContainer>
</Layout>